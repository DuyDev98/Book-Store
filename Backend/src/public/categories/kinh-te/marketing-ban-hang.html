<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>S√°ch Marketing - B√°n H√†ng | bookstore.com</title>

  <!-- BOOTSTRAP -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
  
  <!-- CSS CH√çNH -->
  <link rel="stylesheet" href="../../style.css" />
</head>

<body style="background:#fdf8f8;">

  <!-- HEADER T·ª∞ ƒê·ªòNG -->
  <div id="header"></div>

  <div class="container-fluid py-4">
    <div class="row">

      <!-- SIDEBAR T·ª∞ ƒê·ªòNG -->
      <aside class="col-md-3" id="sidebar"></aside>

      <!-- MAIN CONTENT -->
      <main class="col-md-9">

        <h4 class="fw-bold text-danger mb-4">üìò S√ÅCH MARKETING ‚Äì B√ÅN H√ÄNG</h4>

        <!-- DANH S√ÅCH S√ÅCH -->
        <div class="row g-4" id="book-list">
          <!-- S√°ch load t·ª´ API -->
        </div>

        <!-- N√öT XEM TH√äM -->
        <div class="text-center mt-4">
          <a href="marketing-ban-hang2.html" class="btn btn-view-more fw-bold">Xem th√™m ¬ª</a>
        </div>
      </main>
    </div>
  </div>

  <!-- FOOTER T·ª∞ ƒê·ªòNG -->
  <div id="footer"></div>

  <!-- SCRIPT LOAD COMPONENTS -->
  <script>
    // Load header
    fetch("../../components/header.html")
      .then(res => res.text())
      .then(html => document.getElementById("header").innerHTML = html);

    // Load sidebar
    fetch("../../components/sidebar.html")
      .then(res => res.text())
      .then(html => document.getElementById("sidebar").innerHTML = html);

    // Load footer
    fetch("../../components/footer.html")
      .then(res => res.text())
      .then(html => document.getElementById("footer").innerHTML = html);
  </script>

  <!-- LOAD S√ÅCH T·ª™ API -->
  <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const listEl = document.getElementById("book-list");

      try {
        // API ƒë√∫ng c·ªßa backend
        const res = await fetch("http://localhost:5001/api/sach/category/6");

        if (!res.ok) {
          throw new Error("API l·ªói ho·∫∑c kh√¥ng tr·∫£ v·ªÅ JSON");
        }

        const data = await res.json();
        const books = data.data || [];

        if (books.length === 0) {
          listEl.innerHTML = "<p class='text-danger'>Kh√¥ng t√¨m th·∫•y s√°ch n√†o.</p>";
          return;
        }

        // Render s√°ch
        listEl.innerHTML = books
          .map(book => {
            const imgSrc = "../../images-kinh-te/" + (book.AnhBia || "no-image.png");
            const price = Number(book.GiaBan || 0).toLocaleString("vi-VN") + "ƒë";

            return `
              <div class="col-6 col-sm-4 col-md-3">
                <div class="book-card bg-white shadow-sm rounded h-100 position-relative">
                  <img src="${imgSrc}" class="img-fluid rounded-top" alt="${book.TenSach}" />

                  <div class="p-3">
                    <p class="small fw-semibold text-truncate mb-1">${book.TenSach}</p>
                    <b>${price}</b>
                  </div>

                  <button class="btn-add-cart" data-id="${book.MaSach}">
                    <i class="bi bi-cart-plus"></i>
                  </button>
                </div>
              </div>
            `;
          })
          .join("");

      } catch (err) {
        console.error("L·ªói t·∫£i s√°ch:", err);
        listEl.innerHTML = "<p class='text-danger'>Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu s√°ch.</p>";
      }
    });
  </script>

</body>
</html>
